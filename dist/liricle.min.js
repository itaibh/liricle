var t,e;t=this,e=function(){"use strict";function t(t){let e=Math.floor(t/60),i=(t%60).toFixed(2);return e=e<10?"0"+e:e,i=i<10?"0"+i:i,e+":"+i}function e(t){const e=t.split(":"),i=60*parseInt(e[0]),n=parseFloat(e[1]);return parseFloat((i+n).toFixed(2))}return class{constructor(t){if(t instanceof HTMLElement||(t=document.querySelector(t)),!t)throw Error("[Liricle]: 404 container not found!");this.container=t,this.activeNode=null,this.ready=!1,this.map={}}async init(i){this.ready=!1;try{const n=function(t){const e=t.split("\n"),i=[];return e.forEach((t=>{if(!t)return;const e=t.match(/\[(?<time>.*)\]((?<text>.*))?/);if(!e||!e.groups)return console.warn("invalid line: '"+t+"'");const{time:n,text:o}=e.groups;/\d+:\d\d\.\d+/.test(n)&&i.push({time:n,text:o})})),i}(await fetch(i).then((t=>t.text())));!function(t,e){const i=document.createDocumentFragment();e.forEach(((t,e)=>{const n=document.createElement("div");n.className="liricle-line",n.innerText=t.text||"",i.append(n)})),t.innerHTML="",t.append(i)}(this.container,n),function(i,n,o){const r=i.children;o.forEach(((i,c)=>{let s=i.time,a=o[c+1];if(!a)return;s=e(s),a=e(a.time);const d=a-s,l=r[c];let f=0;for(;f<d;){const e=t(s+f);n[e]=l,f+=.01}}))}(this.container,this.map,n),this.ready=!0}catch(t){throw Error("[Liricle]: "+t)}}sync(e){if(!this.ready)return;const i=t(e),n=this.map[i];n&&this.activeNode!=n&&(this.activeNode&&this.activeNode.classList.remove("active"),this.activeNode=n,this.activeNode.classList.add("active"),this.container.scrollTop=n.offsetTop-this.container.offsetHeight/2)}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Liricle=e();
